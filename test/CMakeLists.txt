 
IF(NOT DEFINED CMAKE_SCRIPT_MODE_FILE)
	CMAKE_MINIMUM_REQUIRED(VERSION 3.16)
	PROJECT(CMLIB_CACHE_TEST)
ENDIF()

LIST(APPEND CMAKE_MODULE_PATH "${CMAKE_CURRENT_LIST_DIR}/../")
FIND_PACKAGE(CMLIB)

INCLUDE("${CMAKE_CURRENT_LIST_DIR}/TEST.cmake")




FUNCTION(RUN_TEST test)
	IF(NOT DEFINED CMAKE_SCRIPT_MODE_FILE)
		EXECUTE_PROCESS(
			COMMAND "${CMAKE_COMMAND}" -D .
			WORKING_DIRECTORY "${CMAKE_CURRENT_LIST_DIR}/${test}"
		)
	ELSE()
		EXECUTE_PROCESS(
			COMMAND "${CMAKE_COMMAND}" -P CMakeLists.txt
			WORKING_DIRECTORY "${CMAKE_CURRENT_LIST_DIR}/${test}"
		)
	ENDIF()
ENDFUNCTION()



RUN_TEST(ARCHIVE)
RUN_TEST(CACHE)
RUN_TEST(FILE_DOWNLOAD)
RUN_TEST(PARSE_ARGUMENTS)
RUN_TEST(REQUIRED_ENV)
RUN_TEST(DEPENDENCY)
RUN_TEST(STORAGE)

