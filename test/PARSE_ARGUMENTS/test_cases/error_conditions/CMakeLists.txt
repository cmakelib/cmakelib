##
#
# Test CMLIB_PARSE_ARGUMENTS error conditions including missing required arguments
# validation, invalid argument combinations behavior, malformed input handling,
# and empty argument specifications processing.
#

IF(NOT DEFINED CMAKE_SCRIPT_MODE_FILE)
	CMAKE_MINIMUM_REQUIRED(VERSION 3.18)
	PROJECT(CMLIB_PARSE_ARGUMENTS_ERROR_CONDITIONS_TEST)
ENDIF()

LIST(APPEND CMAKE_MODULE_PATH "${CMAKE_CURRENT_LIST_DIR}/../../../../")
FIND_PACKAGE(CMLIB REQUIRED)

INCLUDE("${CMAKE_CURRENT_LIST_DIR}/../../../TEST.cmake")

FUNCTION(TEST_MISSING_REQUIRED_ARGUMENTS)
	TEST_INVALID_CMAKE_RUN(
		"${CMAKE_CURRENT_LIST_DIR}/missing_required"
		".*Key.*TEST_VALUE.*not defined.*"
	)
ENDFUNCTION()

FUNCTION(TEST_INVALID_COMBINATIONS)
	CMLIB_PARSE_ARGUMENTS(
		OPTIONS TEST_ARG
		ONE_VALUE TEST_ARG
		P_ARGN
			TEST_ARG "value"
	)
ENDFUNCTION()

FUNCTION(TEST_MALFORMED_INPUT)
	CMLIB_PARSE_ARGUMENTS(
		INVALID_PARAMETER_TYPE TEST_ARG
		P_ARGN
			TEST_ARG "value"
	)
ENDFUNCTION()

FUNCTION(TEST_EMPTY_SPECIFICATIONS)
	CMLIB_PARSE_ARGUMENTS(
		OPTIONS
		ONE_VALUE
		MULTI_VALUE
		P_ARGN
	)
ENDFUNCTION()

TEST_MISSING_REQUIRED_ARGUMENTS()
TEST_INVALID_COMBINATIONS()
TEST_MALFORMED_INPUT()
TEST_EMPTY_SPECIFICATIONS()
