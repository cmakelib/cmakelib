## TYPE=FILE Test
#
# Test DEPENDENCY with TYPE=FILE using file:// URI
#

IF(NOT DEFINED CMAKE_SCRIPT_MODE_FILE)
    CMAKE_MINIMUM_REQUIRED(VERSION 3.18)
    PROJECT(CMLIB_DEPENDENCY_TYPE_FILE_TEST)
ENDIF()

LIST(APPEND CMAKE_MODULE_PATH "${CMAKE_CURRENT_LIST_DIR}/../../../../")
FIND_PACKAGE(CMLIB)

INCLUDE("${CMAKE_CURRENT_LIST_DIR}/../../../TEST.cmake")
INCLUDE("${CMAKE_CURRENT_LIST_DIR}/../../../test_resources/test_resources.cmake")

TEST_RESOURCES_GET_FILE_URI("TEST_MODULE.cmake" FILE_URI)

CMLIB_DEPENDENCY(
    TYPE FILE
    URI "${FILE_URI}"
    OUTPUT_PATH_VAR output_path
)

IF(NOT EXISTS "${output_path}")
    MESSAGE(FATAL_ERROR "TYPE=FILE test failed - output file does not exist: ${output_path}")
ENDIF()
